# # SQL Task â€“ Advanced Database Queries with Window Functions

This task demonstrates advanced SQL queries using window functions, CTEs, and customer analytics techniques to analyze user behavior, sales trends, product performance, and customer segmentation.

---

## ðŸ”¹ Task Queries Included

### ðŸ”¸ Section 1: Customer Lifetime Value (CLV) Analysis

1. **Calculate CLV per customer with running totals**
2. **Rank customers by CLV within their country**
3. **Month-over-month CLV growth per customer**
4. **Identify top 20% of customers by CLV**

---

### ðŸ”¸ Section 2: Sales Trend Analysis

5. **Calculate 7, 30, and 90-day moving averages of daily sales**
6. **Year-over-year monthly sales growth**
7. **Detect seasonal patterns using lag functions**
8. **Rolling retention rates for customer cohorts**

---

### ðŸ”¸ Section 3: Product Performance & Categories

9. **Product sales with full category path (parent â†’ child)**
10. **Product market share within each category**
11. **Top-performing products and their growth**
12. **Declining products using trend detection**

---

### ðŸ”¸ Section 4: Customer Segmentation (RFM)

13. **RFM analysis: Recency, Frequency, Monetary**
14. **Percentile ranks for RFM values**
15. **Customer segmentation based on RFM score**
16. **Track customer segment migration over time**

---

### Notes

- All queries written in standard MySQL (version 8+)
- Each query includes simple English comments above it
- You can find all queries in the `queries.sql` file



